clear allclcfunction re = f(x)  re = sin(2*x) + 0.1*sin(15*x);endfunctionfunction re = g(x)  re = sin(2*x) + 0.1*cos(15*x);endfunctionfunction re = h(x)  re = g(x).*f(x);endfunctionfunction re = index2array(x, N)  if (x >=0 )    re = x+1;  else    re = x+1+N;  endif  endfunctionfunction re = E(x)  re = (sin(2*x)).^2 + 0.1*sin(2*x).*cos(15*x) + 0.1*sin(2*x).*sin(15*x) + sin(30*x)/200;endfunctionfunction re = get_real(fk_hat, x)  k = [[0:1:size(fk_hat)(2)/2-1],[0],[-(size(fk_hat)(2)/2-1):1:-1]];    re = zeros(size(x)(1), size(x)(2));  for a = 1:size(fk_hat)(2)    re += fk_hat(a).*exp(j*k(a)*x);  endfor  re /= 32;endfunctionfunction re = remove_last(x)  L = size(x)(2);  re = x(1:L-1);endfunctionPI = 3.1415926;h_x = 2*PI/32;x = 0:h_x:2*PI;x = remove_last(x);x_ref = 0:0.05:2*PI;fj = f(x);gj = g(x);hj = h(x);Ej = E(x);H_hat = fft(hj);f_hat = fft(fj);g_hat = fft(gj);E_hat = fft(Ej);h_hat = zeros(1,32);for k = -16:15   for m = -16:15     if (k-m >= -16 && k-m <=15)       h_hat(index2array(k,32)) += f_hat(index2array(m,32))*g_hat(index2array(k-m,32));     endif   endforendforh_hat /= 32;figure(1)plot(x_ref, h(x_ref))hold plot(x_ref, get_real(H_hat, x_ref), "--")plot(x, ifft(H_hat),"o")legend("exact", "H hat", "grid point")figure(2)plot(x_ref, h(x_ref))holdplot(x_ref, get_real(h_hat, x_ref), "--")plot(x, ifft(h_hat),"o")legend("exact", "h hat", "grid point")figure(3)plot(x_ref, h(x_ref))holdplot(x_ref, get_real(E_hat, x_ref), "--")plot(x, ifft(E_hat),"o")legend("exact", "E hat", "grid point")