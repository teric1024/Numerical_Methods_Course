clear allclcPI = 3.1415926;h16 = 2*PI/16;h32 = 2*PI/32;x16 = 0:h16:2*PI;x32 = 0:h32:2*PI;xex = 0:0.01:2*PI;function re = f1(x)   re = sin(3*x) + 3*cos(6*x);endfunctionfunction re = f2(x)   re = 6*x - x.*x;endfunctionfunction re = remove_boundary(x)  L=size(x)(2);  re=x(1,2:L-1);endfunctionfunction re = remove_last(x)  L = size(x)(2);  re = x(1:L-1);endfunction#---exact differential---function re = d_f1(x)#differential of the first function   re = -18*sin(6*x) + 3*cos(3*x);endfunctionfunction re = d_f2(x)#differential of the second function   re = 6-2*x;endfunctionexact16_df1 = d_f1(xex);exact32_df1 = d_f1(xex);exact16_df2 = d_f2(xex);exact32_df2 = d_f2(xex);#-------#---central differential---central16_df1 = zeros(1,14);central32_df1 = zeros(1,30);central16_df2 = zeros(1,14);central32_df2 = zeros(1,30);for a = 1:15 #N = 16   central16_df1(a) = (f1(x16(a+2))-f1(x16(a)))/2/h16;   central16_df2(a) = (f2(x16(a+2))-f2(x16(a)))/2/h16;endforfor a = 1:31 #N = 32   central32_df1(a) = (f1(x32(a+2))-f1(x32(a)))/2/h32;   central32_df2(a) = (f2(x32(a+2))-f2(x32(a)))/2/h32;endfor#------#---Differential by Fast Fourier Transform---x16_nl = remove_last(x16);x32_nl = remove_last(x32);f1_16_hat = fft(f1(x16_nl));f1_32_hat = fft(f1(x32_nl));f2_16_hat = fft(f2(x16_nl));f2_32_hat = fft(f2(x32_nl));fft16_df1 = real(ifft(f1_16_hat .*[[0:1:7],[0],[-7:1:-1]] *j));fft32_df1 = real(ifft(f1_32_hat .*[[0:1:15],[0],[-15:1:-1]] *j));fft16_df2 = real(ifft(f2_16_hat .*[[0:1:7],[0],[-7:1:-1]] *j));fft32_df2 = real(ifft(f2_32_hat .*[[0:1:15],[0],[-15:1:-1]] *j));#-------figure(1)plot(remove_boundary(x16), central16_df1, '--x')holdplot(xex, exact16_df1)plot(x16_nl, fft16_df1, '--o')legend("central","exact", "fft")title("for 16 points(f1)")figure(2)plot(remove_boundary(x32), central32_df1, '--x')holdplot(xex, exact32_df1)plot(x32_nl, fft32_df1, '--o')legend("central","exact", "fft")title("for 32 points(f1)")figure(3)plot(remove_boundary(x16), central16_df2, '--x')holdplot(xex, exact16_df2)plot(x16_nl, fft16_df2, '--o')legend("central","exact", "fft")title("for 16 points(f2)")figure(4)plot(remove_boundary(x32), central32_df2, '--x')holdplot(xex, exact32_df2)plot(x32_nl, fft32_df2, '--o')legend("central","exact", "fft")title("for 32 points(f2)")